<div class="downloads d-flex justify-content-between mr-4  mt-2 ml-4 position-relative">
  <div class="d-flex align-items-center">
    <h4 class="mb-0 AvenirLTStd-Heavy">Job Run Date :</h4>
    <h5 class="mb-0 AvenirLTStd-Heavy ml-2">{{applyjobDate|date:'MM/dd/yyyy'}}</h5>
    <span class="material-icons ml-2" [tooltip]="sitecontent1" tooltipPlacement="right">
      help
      <ng-template #sitecontent1>This report has the updated data as of {{applyjobDate|date:'MM/dd/yyyy'}}
      </ng-template>
    </span>
  </div>

  <div>
    <i class="fas fa-file-download mx-3 f-18"></i>
    <i class="fas fa-filter mx-2 f-18" (click)="openFilter(filtermodal)"></i>
  </div>

</div>
<div class="daily-stats-wrapper p-4 ">
  <div class="table-responsive box-shadow">
    <table class="table mb-0" id='excel-table'>
      <thead class="thead-dark">
        <tr class="sticky-top">
          <th scope="col" class="sticky-left" >RVP</th>
          <th scope="col" class="sticky-left" >ED</th>
          <th scope="col" class="sticky-left" >Branch</th>
          <th scope="col" >Operation#</th>
          <th scope="col" >Operation<br> Name</th>
          <th scope="col" >Site#</th>
          <th scope="col" >Site<br> Name</th>
          <th scope="col" > MRN </th>
          <th scope="col" > PS<br> Acct# </th>
          <th scope="col" > PS Last Name</th>
          <th scope="col" > PS First Name</th>
          <th scope="col" > PS Middle Name</th>
          <th scope="col" > PS<br> Coordinator </th>
          <th scope="col" > Service Code </th>
          <th scope="col" > Service Code<br> Description</th>
          <th scope="col" > Payor <br>Plan </th>
          <th scope="col" > Payor Plan<br> Description </th>
          <th scope="col" > Visit Start<br> Date Time</th>
          <th scope="col" > Visit End<br> Date Time</th>
          <th scope="col" > Visit Duration<br> In Hours </th>
          <th scope="col" > Cancellation<br> Reason </th>
          <th scope="col" > Visit<br> Comments </th>
          <th scope="col" > Cancellation<br> Date Time</th>
          <th scope="col" >Visit<br> Status</th>
          <th scope="col" > Scheduled<br> Revenue </th>
          <th scope="col" > Client<br> Class </th>
          <th scope="col" > Client <br>Class Desc</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of  cancelledHoursList">
          <td class="sticky-left" scope="row" >{{item.rvp}}</td>
          <td class="sticky-left">{{item.ed}}</td>
          <td class="sticky-left">{{item.branch}}</td>
          <td>{{item.operation}}</td>
          <td>{{item.operationName}} </td>
          <td>{{item.site}}</td>
          <td>{{item.siteName}}</td>
          <td>{{item.mrn}}</td>
          <td>{{item.psAccountNumber}}</td>
          <td>{{item.psLastName}}</td>
          <td>{{item.psFirstName}}</td>
          <td>{{item.psMidleName}}</td>
          <td>{{item.psCoordinator}}</td>
          <td>{{item.serviceCode}}</td>
          <td>{{item.serviceCodeDescription}}</td>
          <td>{{item.payorPlan}}</td>
          <td>{{item.payorPlanDescription}}</td>
          <td>{{item.visitStartDateTime}}</td>
          <td>{{item.visitEndDateTime}}</td>
          <td>{{item.visitDurationInHrs}}</td>
          <td>{{item.cancellationReason}}</td>
          <td>{{item.visitComments}}</td>
          <td>{{item.cancellationDateTime}}</td>
          <td>{{item.visitStatus}}</td>
          <td>{{item.scheduledRevenue}}</td>
          <td>{{item.clientClass}}</td>
          <td>{{item.clientClassDesc}}</td>



          </tr>
      </tbody>

    </table>
    <p *ngIf="cancelledHoursList.length==0" class="no-records text-center">No Records Found</p>
  </div>
  <div class="pager d-flex justify-content-end mt-2">
    <div class="c">
      <span class="mr-2">Per page</span>
      <select (change)="perpageChange()" [(ngModel)]="perpage" class="border-0 mr-2">
        <option [ngValue]="10">10</option>
        <option [ngValue]="20">20</option>
        <option [ngValue]="30">30</option>
        <option [ngValue]="40">40</option>
        <option [ngValue]="50">50</option>
        <!-- <option [ngValue]="100" >100</option> -->



      </select>
      <span class="mr-2">Showing {{ totalRecordsCount!=0?lowerBound:0}} to
        {{upperBound>totalRecordsCount?totalRecordsCount:upperBound}} of
        {{totalRecordsCount}}
      </span>

      <button [disabled]="lowerBound==1" (click)="prevPage()" type="button" class="btn-common-small mx-2">Prev</button>
      <button [disabled]="upperBound>totalRecordsCount" (click)="nextPage()" type="button"
        class="btn-common-small mx-2">Next</button>
    </div>
  </div>
</div>

<ng-template #filtermodal>
  <div class="modal-header bg-dark">
    <h5 class="modal-title text-white" id="exampleModalLabel">
      Evv Filter
    </h5>
    <button type="button" class="close" (click)="modelRef.hide()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row measures-wrapper">
      <div class="col-md-6  mb-3 ">
        <div class="card-header d-flex justify-content-between align-items-center box-shadow">
          <h5 class="m-0">Job Run Date <span class="text-danger">*</span></h5>
          <input class="form-control bg-light-grey" [(ngModel)]="jobRunDate" style="width: auto" type="text"
            bsDatepicker placeholder="MM/DD/YYYY" />
        </div>
      </div>
    </div>
    <div class="row measures-wrapper">
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select RVP's </h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">

              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">

                  <p-multiSelect [options]="rvpList" (onPanelHide)="getEDList()" [(ngModel)]="selectedRvpList"
                    optionLabel="operationOfficerName" selectedItemsLabel="{0} items selected"
                    class="multiselect-custom"></p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let item of selectedRvpList">{{item.operationOfficerName}}</li>
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select ED's </h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">

              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <p-multiSelect [options]="edsList" (onPanelHide)="getBMList()" [(ngModel)]="selectedEdList"
                    maxSelectedLabels="1" optionLabel="executiveDirectorName" [panelStyle]="{ minWidth: '15em' }"
                    [itemSize]="30" selectedItemsLabel="{0} items selected" [virtualScroll]="true"
                    class="multiselect-custom">
                  </p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let  item of selectedEdList">{{item.executiveDirectorName}}</li>

            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="row measures-wrapper">
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select Branches </h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">

              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <p-multiSelect [options]="bmList" class="multiselect-custom" (onPanelHide)="getSiteList()"
                    [(ngModel)]="selectedBranches" maxSelectedLabels="1" optionLabel="branchManagerName"
                    selectedItemsLabel="{0} items selected"></p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let item of selectedBranches">{{item.branchManagerName}}</li>
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select Sites</h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">

              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <p-multiSelect [dataKey]="'siteId'" [options]="siteList" [panelStyle]="{ minWidth: '15em' }"
                    [itemSize]="30" class="multiselect-custom" [virtualScroll]="true" [(ngModel)]="selectedSites"
                    maxSelectedLabels="1" optionLabel="siteName" selectedItemsLabel="{0} items selected">
                  </p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let  item of selectedSites">{{item.siteName}}</li>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-between align-items-center">
      <button type="button" (click)="modelRef.hide()" class="btn btn-primary mx-2 px-3 border-radius-curved py-2"><i
          class="fas fa-times mr-1"></i>Close</button>
      <button type="button" (click)="onApply()" class="btn btn-success mx-2 px-3 border-radius-curved py-2"><i
          class="fas fa-check mr-1"></i>Apply</button>
    </div>
  </div>
</ng-template>
