<div class="navigation d-flex justify-content-center position-relative pt-2">
  <!-- <div></div> -->
  <!-- <div class="d-flex align-items-center ml-4">
    <h4 class="mb-0 AvenirLTStd-Heavy">Job Run Date :</h4>
    <h5 class="mb-0 AvenirLTStd-Heavy ml-2">{{applyjobDate|date:'MM/dd/yyyy hh:mm a'}}</h5>
    <span class="material-icons ml-2" [tooltip]="sitecontent1"
    tooltipPlacement="right">
      help
      <ng-template #sitecontent1>This report has the updated data as of {{applyjobDate|date:'MM/dd/yyyy hh:mm a'}}
      </ng-template>
      </span>
  </div> -->


  <div class="">
    <ul class="nav nav-pills mb-2">
      <li class="nav-item mx-3" [tooltip]="months[currentMonth -1]">
        <a class="nav-link" (click)="onMonthChange(-1,months[jobRunDate.getMonth() -1])" [ngClass]="monthFlag==-1?'active border-radius-curved':''"><i
            class="fa fa-arrow-left mr-1"></i>Prev</a>
      </li>
      <li class="nav-item mx-3" [tooltip]="months[currentMonth]">
        <a class="nav-link" (click)="onMonthChange(0,months[jobRunDate.getMonth()])"
          [ngClass]="monthFlag==0?'active border-radius-curved':''">Current</a>
      </li>
      <li class="nav-item mx-3" [tooltip]="months[currentMonth+1]">
        <a class="nav-link" (click)="onMonthChange(1,months[currentMonth+1])" [ngClass]="monthFlag== 1?'active border-radius-curved':''">Next<i
            class="fa fa-arrow-right ml-1"></i></a>
      </li>
    </ul>
  </div>
  <div class="downloads d-flex align-items-center mr-3 float-right position-absolute filter-d-i">
    <i class="fas fa-file-download mx-3 f-18" (click)="exportexcel2()" title="Download"></i>
    <i class="fas fa-filter mx-2 f-18" (click)="openFilter(filtermodal)"></i>
  </div>
</div>



<div class="daily-stats-wrapper px-4 pb-2">
  <div class="table-responsive box-shadow">
    <table class="table mb-0" id='excel-table' [ngClass]="{'daily-stats-table': dailyStatsList.length==0}">
      <thead class="thead-dark">
        <tr>
          <th scope="col" class="sticky-top sticky-left sticky-top-th left-0">RVP</th>
          <th scope="col" class="sticky-top sticky-left sticky-top-th left-97">ED</th>
          <th scope="col" class="sticky-top sticky-left sticky-top-th left-277 ">BRANCH</th>
          <th scope="col" class="sticky-top">Authorized&nbsp;<br/>Hours</th>
          <th scope="col" class="sticky-top">Scheduled Hours <br><span>&nbsp;(including cancellations)</span></th>
          <th scope="col" class="sticky-top"> % Authorized Hours Scheduled<br>&nbsp;<span>(including cancellations)</span>
          </th>
          <th scope="col" class="sticky-top">Cancelled&nbsp; <br/>Hours </th>
          <th scope="col" class="sticky-top"> Cancellation&nbsp; <br>% </th>
          <th scope="col" class="sticky-top"> No Need&nbsp;<br>Hours</th>
          <th scope="col" class="sticky-top"> PS No Need<br/>&nbsp;%</th>
          <th scope="col" class="sticky-top"> Scheduled less Cancelled/<br> No Need Hours </th>
          <th scope="col" class="sticky-top"> % Authorized  Hours Scheduled<br>&nbsp;(after Cancellations/no need) </th>
          <th scope="col" class="sticky-top"> Scheduled Hours w/a&nbsp;<br>DCS Assigned </th>
          <th scope="col" class="sticky-top"> Scheduled Hours w/no&nbsp;<br>DCS Assigned</th>
          <th scope="col" class="sticky-top">% Scheduled Hours<br>&nbsp;not Staffed </th>
          <th scope="col" class="sticky-top"> Serviced<br/>&nbsp;Hours </th>
          <th scope="col" class="sticky-top"> Served<br>&nbsp;Utilization </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of  dailyStatsList">
          <td scope="row" class="sticky-left left-0">{{item.rvp}}</td>
          <td class="sticky-left left-97 td">{{item.ed}}</td>
          <td class="sticky-left left-277 td">{{item.branch}}</td>
          <td>{{item.authorizedHrs}}</td>
          <td>{{item.scheduledHrs}} </td>
          <td>{{item.percentOfAuthSchHrs}}</td>
          <td>{{item.cancelledHrs}}</td>
          <td>{{item.percentOfCancelHrs}}</td>
          <td>{{item.noNeedHrs}}</td>
          <td>{{item.percentOfNoNeedHrs}}</td>
          <td>{{item.scheduledHrsWithoutCancel}}</td>
          <td>{{item.perOfSchLessCancelHrs}}</td>
          <td>{{item.sumScheduledHrsWithDcs}}</td>
          <td>{{item.sumScheduledHrsWithNoDcs}}</td>
          <td>{{item.scheduledWithNoDcsPercent}}</td>
          <td>{{item.servicedHrs}}</td>
          <td>{{item.servicedHrsPercent}}</td>
        </tr>
      </tbody>
      <tfoot class="daily-report-foot" *ngIf="dailyStatsList.length!=0">
        <tr class="border-top">
          <td colspan="3" class="sticky-left left-0 border-top AvenirLTStd-Heavy">Grand Totals</td>

          <td class="AvenirLTStd-Heavy">{{grandtotal?.authorizedHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.scheduledHrs}} </td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.percentOfAuthSchHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.cancelledHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.percentOfCancelHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.noNeedHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.percentOfNoNeedHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.scheduledHrsWithoutCancel}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.perOfSchLessCancelHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.sumScheduledHrsWithDcs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.sumScheduledHrsWithNoDcs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.scheduledWithNoDcsPercent}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.servicedHrs}}</td>
          <td class="AvenirLTStd-Heavy">{{grandtotal?.servicedHrsPercent}}</td>
        </tr>
      </tfoot>
    </table>
    <p *ngIf="dailyStatsList.length==0" class="no-records text-center">No Records Found</p>
  </div>
  <div class="d-flex align-items-center justify-content-center mt-1">
      <p class="mb-0 AvenirLTStd-Heavy ">This report has the updated data as of {{jobsuccessrunDate|date:'MM/dd/yyyy hh:mm a'}} </p>
  </div>
</div>

<ng-template #filtermodal>
  <div class="modal-header bg-dark">
    <h5 class="modal-title text-white" id="exampleModalLabel">
      Branch Scheduled Hours Breakdown
    </h5>
    <button type="button" class="close" (click)="modelRef.hide()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row measures-wrapper">
      <div class="col-md-6  mb-3 ">
        <div class="card-header d-flex justify-content-between align-items-center box-shadow">
          <h5 class="m-0">Job Run Date <span class="text-danger">*</span></h5>
          <input class="form-control bg-light-grey" [(ngModel)]="jobRunDate" style="width: auto" type="text"
            bsDatepicker placeholder="MM/DD/YYYY" />
        </div>
      </div>
    </div>
    <div class="row measures-wrapper">
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select RVP's </h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">
                <!-- <h5 class="mb-0 text-white"> RVP's</h5> -->
                <!-- <span class="text-danger">*</span> -->
              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <!-- <angular2-multiselect >
                  </angular2-multiselect> -->
                  <p-multiSelect [options]="rvpList" [resetFilterOnHide]="true" (onPanelHide)="getEDList()" [(ngModel)]="selectedRvpList"
                    optionLabel="operationOfficerName" selectedItemsLabel="{0} items selected"  maxSelectedLabels="1"
                    class="multiselect-custom"></p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let item of selectedRvpList">{{item.operationOfficerName}}</li>
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select ED's</h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">
                <!-- <h5 class="mb-0 text-white"> ED's</h5> -->
                <!-- <span class="text-danger">*</span> -->
              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <p-multiSelect [options]="edsList"[resetFilterOnHide]="true" (onPanelHide)="getBMList()" [(ngModel)]="selectedEdList"
                    maxSelectedLabels="1" optionLabel="executiveDirectorName" [panelStyle]="{ minWidth: '15em' }"
                    [itemSize]="30" selectedItemsLabel="{0} items selected" [virtualScroll]="true"
                    class="multiselect-custom">
                  </p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let  item of selectedEdList">{{item.executiveDirectorName}}</li>

            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="row measures-wrapper">
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select Branches</h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">
                <!-- <h5 class="mb-0 text-white"> Branches</h5> -->
                <!-- <span class="text-danger">*</span> -->
              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <p-multiSelect [options]="bmList" [resetFilterOnHide]="true" class="multiselect-custom" [(ngModel)]="selectedBranches"
                    maxSelectedLabels="1" optionLabel="branchManagerName" selectedItemsLabel="{0} items selected">
                  </p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let item of selectedBranches">{{item.branchManagerName}}</li>

            </p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card bg-light mb-3 box-shadow">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="m-0">Select Payor Class</h5>
            <div class="d-flex mr-3 align-items-center" style="width: 55%">
              <label class="site-label color-black">
                <!-- <h5 class="mb-0 text-white"> Payor Class</h5> -->
                <!-- <span class="text-danger">*</span> -->
              </label>
              <div class="input-group">
                <div class="procedurecode w-100 multiselect-angular">
                  <p-multiSelect [dataKey]="'value'" [resetFilterOnHide]="true" [options]="payorClass" [panelStyle]="{ minWidth: '15em' }"
                    [itemSize]="10" class="multiselect-custom" [virtualScroll]="true" [(ngModel)]="selectedPayorClass"
                    maxSelectedLabels="1" optionLabel="value" selectedItemsLabel="{0} items selected">
                  </p-multiSelect>

                </div>
              </div>
            </div>
          </div>
          <div class="card-body filter-card-body">
            <p class="card-text">
              <li *ngFor="let  item of selectedPayorClass">{{item.value}}</li>

            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-between align-items-center">
      <button type="button" (click)="modelRef.hide()" class="btn btn-primary mx-2 px-3 border-radius-curved py-2"><i
          class="fas fa-times mr-1"></i>Close</button>
      <button type="button" (click)="onApply()" class="btn btn-success mx-2 px-3 border-radius-curved py-2"><i
          class="fas fa-check mr-1"></i>Apply</button>
    </div>
  </div>



</ng-template>
